<!doctype html>
<head><meta charset="utf-8">
<title>String.prototype.replaceAll</title><script type="application/json" id="menu-search-biblio">[{"type":"clause","id":"sec-string.prototype.replaceall","aoid":null,"title":"String.prototype.replaceAll ( searchValue, replaceValue )","titleHTML":"String.prototype.replaceAll ( <var>searchValue</var>, <var>replaceValue</var> )","number":"1","namespace":"https://tc39.github.io/proposal-string-replace-all/","location":"","referencingIds":[],"key":"String.prototype.replaceAll ( searchValue, replaceValue )"}]</script></head><body><div id="menu-toggle">☰</div><div id="menu-spacer"></div><div id="menu"><div id="menu-search"><input type="text" id="menu-search-box" placeholder="Search..."><div id="menu-search-results" class="inactive"></div></div><div id="menu-pins"><div class="menu-pane-header">Pins</div><ul id="menu-pins-list"></ul></div><div class="menu-pane-header">Table of Contents</div><div id="menu-toc"><ol class="toc"><li><span class="item-toggle-none"></span><a href="#sec-string.prototype.replaceall" title="String.prototype.replaceAll ( searchValue, replaceValue )"><span class="secnum">1</span> String.prototype.replaceAll ( <var>searchValue</var>, <var>replaceValue</var> )</a></li></ol></div></div><div id="spec-container"><h1 class="version first">Stage 1 Draft / March 5, 2019</h1><h1 class="title">String.prototype.replaceAll</h1>
<script src="ecmarkup.js" defer=""></script>
<link rel="stylesheet" href="ecmarkup.css">
<style>
  ins.block {
    font-weight: bold;
    font-style: italic;
  }
  hr {
    height: 0.25em;
    background: #ccc;
    border: 0;
    margin: 2em 0;
  }

</style>

<emu-clause id="sec-string.prototype.replaceall">
  <h1><span class="secnum">1</span>String.prototype.replaceAll ( <var>searchValue</var>, <var>replaceValue</var> )</h1>
  <p>When the <code>replaceAll</code> method is called with arguments <var>searchValue</var> and <var>replaceValue</var>, the following steps are taken:</p>
  <emu-alg><ol><li>Let <var>O</var> be ?&nbsp;<emu-xref aoid="RequireObjectCoercible" id="_ref_0"><a href="https://tc39.github.io/ecma262/#sec-requireobjectcoercible">RequireObjectCoercible</a></emu-xref>(<emu-val>this</emu-val> value).</li><li>If <var>searchValue</var> is neither <emu-val>undefined</emu-val> nor <emu-val>null</emu-val>, then<ol><li>Let <var>replacer</var> be ?&nbsp;<emu-xref aoid="GetMethod" id="_ref_1"><a href="https://tc39.github.io/ecma262/#sec-getmethod">GetMethod</a></emu-xref>(<var>searchValue</var>, @@replace).</li><li>If <var>replacer</var> is not <emu-val>undefined</emu-val>, then<ol><li>Return ?&nbsp;<emu-xref aoid="Call" id="_ref_2"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>replacer</var>, <var>searchValue</var>, « <var>O</var>, <var>replaceValue</var> »).</li></ol></li></ol></li><li>Let <var>string</var> be ?&nbsp;<emu-xref aoid="ToString" id="_ref_3"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>O</var>).</li><li>Let <var>searchString</var> be ?&nbsp;<emu-xref aoid="ToString" id="_ref_4"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>searchValue</var>).</li><li>Let <var>functionalReplace</var> be <emu-xref aoid="IsCallable" id="_ref_5"><a href="https://tc39.github.io/ecma262/#sec-iscallable">IsCallable</a></emu-xref>(<var>replaceValue</var>).</li><li>If <var>functionalReplace</var> is <emu-val>false</emu-val>, then<ol><li>Set <var>replaceValue</var> to ?&nbsp;<emu-xref aoid="ToString" id="_ref_6"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>replaceValue</var>).</li></ol></li><li>Search <var>string</var> for the first occurrence of <var>searchString</var> and let <var>pos</var> be the index within <var>string</var> of the first code unit of the matched substring and let <var>matched</var> be <var>searchString</var>. If no occurrences of <var>searchString</var> were found, return <var>string</var>.</li><li>If <var>functionalReplace</var> is <emu-val>true</emu-val>, then<ol><li>Let <var>replValue</var> be ?&nbsp;<emu-xref aoid="Call" id="_ref_7"><a href="https://tc39.github.io/ecma262/#sec-call">Call</a></emu-xref>(<var>replaceValue</var>, <emu-val>undefined</emu-val>, « <var>matched</var>, <var>pos</var>, <var>string</var> »).</li><li>Let <var>replStr</var> be ?&nbsp;<emu-xref aoid="ToString" id="_ref_8"><a href="https://tc39.github.io/ecma262/#sec-tostring">ToString</a></emu-xref>(<var>replValue</var>).</li></ol></li><li>Else,<ol><li>Let <var>captures</var> be a new empty <emu-xref href="#sec-list-and-record-specification-type"><a href="https://tc39.github.io/ecma262/#sec-list-and-record-specification-type">List</a></emu-xref>.</li><li>Let <var>replStr</var> be <emu-xref aoid="GetSubstitution" id="_ref_9"><a href="https://tc39.github.io/ecma262/#sec-getsubstitution">GetSubstitution</a></emu-xref>(<var>matched</var>, <var>string</var>, <var>pos</var>, <var>captures</var>, <emu-val>undefined</emu-val>, <var>replaceValue</var>).</li></ol></li><li>Let <var>tailPos</var> be <var>pos</var> + the number of code units in <var>matched</var>.</li><li>Let <var>newString</var> be the string-concatenation of the first <var>pos</var> code units of <var>string</var>, <var>replStr</var>, and the trailing substring of <var>string</var> starting at index <var>tailPos</var>. If <var>pos</var> is 0, the first element of the concatenation will be the empty String.</li><li>Return <var>newString</var>.
  </li></ol></emu-alg>
  <emu-note><span class="note">Note</span><div class="note-contents">
    <p>The <code>replaceAll</code> function is intentionally generic; it does not require that its <emu-val>this</emu-val> value be a String object. Therefore, it can be transferred to other kinds of objects for use as a method.</p>
  </div></emu-note>
</emu-clause></div></body>